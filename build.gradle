description = 'A trivial Gradle build'
version = '1.0'

task buildNRun() {
  description 'Build the docker image.'
  buildDocker()
  showBuildedImage()
  runDocker()
  showRunnigContainer()
}

def buildDocker() {
  description 'Build the docker image.'
  exec {
    commandLine "docker", "build", "-t",  "kafka-graphql:v1",  "."
  }
}

def showBuildedImage() {
  exec {
    commandLine "docker", "images", "kafka-graphql"
  }
}

def runDocker() {
  description 'run the docker image.'
  exec {
    commandLine "docker", "run", "-d", "-p", "8080:8080", "--name=kafka-graphql", "kafka-graphql:v1"
  }
}

def showRunnigContainer(){
  exec {
    commandLine "docker", "ps", "-a", "-f", "name=kafka-graphql"
  }
}
